

<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Docflow</title>
  <link rel="stylesheet" href="https://dojotoolkit.org/documentation/tutorials/1.10/_common/demo.css" media="screen">
  <link rel="stylesheet" href="https://dojotoolkit.org/documentation/tutorials/1.10/dijit_layout/demo/style.css" media="screen">
  <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/dojo/1.10.4/dijit/themes/claro/claro.css" media="screen">
  <script>dojoConfig = {parseOnLoad: true}</script>
</head>
<body class="claro">
<div id="appLayout" class="demoLayout"></div>
<div id="test" ></div>
</body>
<div id="header">
  Сотрудник: <select id="select-employee"></select>
</div>
<!--<script src="resources/js/dojoConfig.js"></script>-->

<script src="webjars/dojo/1.10.4/dojo/dojo.js"></script>
<script type="text/javascript" src="resources/js/header.js"></script>
<!--<script type="text/javascript" src="resources/js/main.js"></script>-->
<script>

  function getOrganizations(item){
    require(["dojo/dom", "dojo/request", "dojo/json",
              "dojo/_base/array", "dojo/domReady!"],
            function(dom, request, JSON, arrayUtil){
              // Results will be displayed in resultDiv
              var resultDiv = dom.byId("mainTab");
              var REST_URL ="/docflow/rest/v1/";
              // Request the JSON data from the server
              request.get(REST_URL+item.id+"/", {
                // Parse data from JSON to a JavaScript object
                handleAs: "json"
              }).then(function(data){
                        // Display the data sent from the server
                        var html = "";

                        arrayUtil.forEach(data, function(item,i){
                          html += "<div"+" data-id="+item.id+"> " + item.name +"</div>";
                        });


                        resultDiv.innerHTML = html;
                      },
                      function(error){
                        // Display the error returned
                        resultDiv.innerHTML = error;
                      });
            }
    );
  }

  require(["dojo/_base/window", "dojo/store/Memory",  "dijit/tree/ObjectStoreModel"
            ,"dijit/Tree","dijit/registry","dijit/layout/BorderContainer"
            , "dijit/layout/TabContainer", "dijit/layout/ContentPane", "dojo/domReady!"],
          function(win, Memory, ObjectStoreModel, Tree, registry,BorderContainer, TabContainer,ContentPane){
            // create the BorderContainer and attach it to our appLayout div
            var appLayout = new BorderContainer({
              design: "headline"
            }, "appLayout");


            // create the TabContainer
            var contentTabs = new TabContainer({
              region: "center",
              id: "contentTabs",
              tabPosition: "bottom",
              "class": "centerPanel"
            });

            // add the TabContainer as a child of the BorderContainer
            appLayout.addChild( contentTabs );

            // create and add the BorderContainer edge regions
            appLayout.addChild(
                    new ContentPane({
                      region: "top",
                      "class": "edgePanel"
                    },"header")
            );
            var left = new ContentPane({
              region: "left",
              id: "leftCol", "class": "edgePanel",
              content: "Sidebar content (left)",
              splitter: true
            });


            // Create test store, adding the getChildren() method required by ObjectStoreModel
            var myStore = new Memory({
              data: [
                { id: 'world', name:'The earth', type:'planet', population: '6 billion'},
                { id: 'AF', name:'Africa', type:'continent', population:'900 million', area: '30,221,532 sq km',
                  timezone: '-1 UTC to +4 UTC', parent: 'world', onClick: getOrganizations},
                { id: 'organizations', name:'Egypt', type:'country', parent: 'AF' },
                { id: 'KE', name:'Kenya', type:'country', parent: 'AF' },
                { id: 'Nairobi', name:'Nairobi', type:'city', parent: 'KE' },
                { id: 'Mombasa', name:'Mombasa', type:'city', parent: 'KE' },
                { id: 'SD', name:'Sudan', type:'country', parent: 'AF' },
                { id: 'Khartoum', name:'Khartoum', type:'city', parent: 'SD' },
                { id: 'AS', name:'Asia', type:'continent', parent: 'world' },
                { id: 'CN', name:'China', type:'country', parent: 'AS' },
                { id: 'IN', name:'India', type:'country', parent: 'AS' },
                { id: 'RU', name:'Russia', type:'country', parent: 'AS' },
                { id: 'MN', name:'Mongolia', type:'country', parent: 'AS' },
                { id: 'OC', name:'Oceania', type:'continent', population:'21 million', parent: 'world'},
                { id: 'EU', name:'Europe', type:'continent', parent: 'world' },
                { id: 'DE', name:'Germany', type:'country', parent: 'EU' },
                { id: 'FR', name:'France', type:'country', parent: 'EU' },
                { id: 'ES', name:'Spain', type:'country', parent: 'EU' },
                { id: 'IT', name:'Italy', type:'country', parent: 'EU' },
                { id: 'NA', name:'North America', type:'continent', parent: 'world' },
                { id: 'SA', name:'South America', type:'continent', parent: 'world' }
              ],
              getChildren: function(object){
                return this.query({parent: object.id});
              }
            });

            // Create the model
            var myModel = new ObjectStoreModel({
              store: myStore,
              query: {id: 'world'}
            });

            // Create the Tree.
            var tree = new Tree({
              model: myModel,
              getDomNodeById: function( id ) // new function to find DOM node
              {
                return this._itemNodesMap[ id ][0];
              },
              onClick: getOrganizations
            });

//            tree.placeAt(win.body());
//            tree.startup();
            left.addChild(tree);
            appLayout.addChild(left);

            // Add initial content to the TabContainer
            contentTabs.addChild(
                    new ContentPane({
                      href: "contentGroup1.html",
                      title: "Group 1",
                      content: "<div id="+"mainTab"+"></div>"
                    })
            );




            // start up and do layout
            appLayout.startup();

            require([
              "dojox/grid/DataGrid",
              "dojo/store/Memory",
              "dojo/data/ObjectStore",
              "dojo/request",
              "dojo/domReady!"
            ], function(DataGrid, Memory, ObjectStore, request){
              var grid,  dataStore;
              request.get("/docflow/rest/v1/organizations",{
                handleAs: "json"
              }).then(function(data){
                dataStore = new ObjectStore({ objectStore:new Memory({ data: data.items }) });

                grid = new DataGrid({
                  store: dataStore,
                  query: { id: "*" },
                  queryOptions: {},
                  structure: [
                    { name: "First Name", field: "name", width: "25%" },
                    { name: "Last Name", field: "name", width: "25%" },
                    { name: "G", field: "name", width: "10%" },
                    { name: "AB", field: "name", width: "10%" },
                    { name: "R", field: "name", width: "10%" },
                    { name: "H", field: "name", width: "10%" },
                    { name: "RBI", field: "name", width: "10%" }
                  ]
                }, "mainTab");
                grid.startup();
              });
            });

          });

</script>
</html>
